<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
    <title>A responsive educational game to help toddlers learn numbers and astronomy. Designed to work on any device, on fullscreen mode. A touch screen is recommended but not required.</title>
    <style>
        html, body {
            overflow: hidden;
            height: 100%;
            width: 100%;
            margin: 0;
        }

        body.sky {
            color: #fff;
            background: linear-gradient(180deg, MidnightBlue 0%, MidnightBlue 25%, DeepSkyBlue 88%, DeepSkyBlue 91%,LimeGreen 91%,LimeGreen 100%);
            background-size: 400% 400%;
            background-position: 50% 100%
        }

        body.lift-off {
            animation: Gradient 10s 1;
            animation-fill-mode: forwards;
        }


        @keyframes Gradient {
            0% {
                background-position: 50% 100%
            }

            100% {
                background-position: 50% 0%
            }
        }

        svg, span, div {
            position: absolute;
        }

        span {
            display: inline-block;
            text-align: center;
        }

        .num {
            font-family: 'Comic Sans MS';
            font-size: 9.5vw;
            line-height: 9.5vw;
            width: 9.5vw;
            height: 9.5vw;
            font-weight: bold;
            user-select: none;
            z-index: 2;
            cursor: pointer;
            padding: 5%;
        }

            .num.num-locked {
                padding: 0;
            }

        #container {
            position: relative;
            padding-bottom: 56.25%;
            width: 100%;
        }

        .num-hold {
            position: absolute;
            width: 9.5vw;
            height: 9.8vw;
            z-index: 1;
            top: 72%;
        }

            .num-hold:before {
                content: "";
                background: white;
                margin: 6%;
                width: 88%;
                height: 88%;
                display: block;
            }

        #play {
            width: 15%;
            height: 25%;
            top: 40%;
            left: 45%;
            cursor: pointer;
        }

        #rocket {
            width: 9.5vw;
            height: 9.5vw;
            top: 53%;
            left: 45%;
        }

        .hide {
            display: none;
        }

        #planet {
            width: 30vw;
            height: 30vw;
            background-repeat: no-repeat;
            background-size: contain;
            background-image: url(./svg/planet1.svg);
            left: 15%;
            top: -70%;
        }

        .transit {
            -webkit-transform: translateY(400%);
            transform: translateY(400%);
            transition: transform 18s linear;
        }
    </style>

    <script src="https://code.jquery.com/jquery-3.3.1.min.js"
            integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
            crossorigin="anonymous"></script>

    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"
            integrity="sha256-VazP97ZCwtekAsvgPBSUwPFKdrwD3unUfSGVYrahUqU="
            crossorigin="anonymous"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui-touch-punch/0.2.3/jquery.ui.touch-punch.min.js"
            crossorigin="anonymous"></script>

    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css">


    <script>
        var dev = 0;
        var colors = ["red", "blue", "green", "darkorange", "gold", "purple", "black", "brown", "gray"];
        var audioI = 0;
        var audio;
        var iteration = 0;
        var speed = 1;

        function getRandomInt(min, max) {
            min = Math.ceil(min);
            max = Math.floor(max);
            return Math.floor(Math.random() * (max - min)) + min; //The maximum is exclusive and the minimum is inclusive
        }

        function shuffle(o) {
            for (var j, x, i = o.length; i; j = parseInt(Math.random() * i), x = o[--i], o[i] = o[j], o[j] = x);
            return o;
        };

        function testHolder(element, goForwards) {
            var number = element.text();
            var hold = $('.hold' + number);
            var num = $('.num' + number);
            var holdCoord = { x: hold.offset().left, y: hold.offset().top };
            var numCoord = { x: num.offset().left, y: num.offset().top };
            var parsedNumber = parseInt(number, 10);
            var firstNumber = goForwards ? 1 : 9;
            var previousNumber = goForwards ? parsedNumber - 1 : parsedNumber + 1;
            var isValid = (parsedNumber === firstNumber) || !$('.num' + previousNumber).hasClass('num-unlocked');
            var distance = window.innerWidth / 5;

            var success = Math.abs(holdCoord.x - numCoord.x) < distance && Math.abs(holdCoord.y - numCoord.y) < distance;
            if (isValid && success) {
                if (audio) {
                    audio.load();
                }
                if (audioI === 4) {
                    audioI = 1;
                }
                else {
                    audioI++;
                }

                audio = document.getElementById("so" + audioI);
                audio.play();
                num.animate({
                    top: hold.css('top'),
                    left: hold.css('left'),
                    padding: 0
                }, 300, function () {
                    $(this).addClass('flip').removeClass('num-unlocked');
                    testRocket();
                });
                num.draggable("destroy");
                return;
            }

            if (numCoord.y < 0) {
                num.animate({
                    top: window.innerHeight / 3
                }, { queue: false, duration: 1000 });
            }

            if (numCoord.x < 0) {
                num.animate({
                    left: window.innerWidth / 3
                }, { queue: false, duration: 1000 });
            }

            var minBottom = window.innerHeight * 0.55;
            if (numCoord.y > minBottom) {
                num.animate({
                    top: "-=50%"
                }, { queue: false, duration: 1000 });
            }

            var minRight = window.innerWidth * 0.80;
            if (numCoord.x > minRight) {
                num.animate({
                    left: "-=50%"
                }, { queue: false, duration: 1000 });
            }
        }

        function testRocket() {
            if (!$('.num-unlocked').length) {
                audio.load();
                audio = document.getElementById("so5");
                audio.play();
                $("#fire-red, #fire-yellow").css("display", "block");
                setTimeout(showPlanet, 13500 * speed);
                setTimeout(liftOff, 7500 * speed);
                $('#rocket').animate({
                    top: '-=40%',
                }, 8000 * speed, 'easeInCubic');
            }
        }

        function liftOff() {
            $('.num, .num-hold').animate({
                top: '+=500%',
            },
                {
                    duration: 7000 * speed,
                    queue: false,
                    complete: function () { $(this).remove(); }
                });
            $("body").addClass("lift-off");
        }

        function showPlanet() {
            $("#planet").addClass("transit");
            setTimeout(restart, 20000 * speed);
        }

        function restart() {
            $("#fire-red, #fire-yellow").css("display", "none");
            audioI = 0;
            iteration++;
            $('.num').remove();
            $('#rocket, #planet').removeAttr('style').removeClass("transit");
            $('#planet').css('background-image', 'url(./svg/planet' + Math.min(iteration, 9) + '.svg)');
            $('body').removeClass('lift-off');
            createNumbers();
        }

        function createNumber(shuffledColors, container, coords, i, forwards) {
            var colorNum = getRandomInt(0, 9);
            var left;
            var top;
            var numberLocked = i > iteration;
            var cssClass;

            let holdLeft = forwards ? (5 + (10 * (i - 1))) : (85 - (10 * (i - 1)));
            container.append("<div class='num-hold hold" + i + "' style='background-color:" + shuffledColors[i - 1] + ";left:" + holdLeft + "%' ></div>");

            if (numberLocked) {
                top = '72';
                left = holdLeft;
                cssClass = 'num-locked';
            }
            else {
                left = getRandomInt(0, 85);
                top = getRandomInt(0, 45);
                cssClass = 'num-unlocked';

                while (coords.some(function (coord) {
                    return Math.abs(coord.x - left) < 15 && Math.abs(coord.y - top) < 15;
                })) {
                    left = getRandomInt(0, 85);
                    top = getRandomInt(0, 45);
                }
            }

            coords[i] = { x: left, y: top };

            container.append("<span class='" + cssClass + " num animated zoomIn num" + i + "' style='color:" + shuffledColors[i - 1] + ";top:" + top + "%;left:" + left + "%; z-index:" + (100 - holdLeft) + "' >" + i + "</span>");

        }

        function createNumbers() {
            var container = $("#container");
            var shuffledColors = shuffle(colors);
            var coords = new Array(11);
            coords[0] = { x: 45, y: 40 };
            var goForwards = true;

            for (var i = 1; i < 10; i++) {
                createNumber(shuffledColors, container, coords, i, goForwards);
            };

            $(".num-unlocked").draggable({ cursor: "move", stop: function (event, ui) { testHolder($(this), goForwards); } });
        }

        function setFullScreen() {
            if (dev) {
                return;
            }

            let html = $("html")[0];

            if (html.requestFullscreen) {
                html.requestFullscreen();
            }

            if (html.webkitRequestFullscreen) {
                html.webkitRequestFullscreen();
            }

            if (html.mozRequestFullScreen) {
                html.mozRequestFullScreen();
            }

            if (html.msRequestFullscreen) {
                html.msRequestFullscreen();
            }
        }

        function startGame(startButton) {
            iteration++;
            setFullScreen();

            if (!dev) {
                if ((window.innerHeight > window.innerWidth)) {
                    alert("Please set Landscape orientation on your device before continuing.");
                    
                }
            }

            startButton.hide();
            $("#rocket").removeClass("hide");
            $("body").addClass("sky");
            createNumbers();
        }

        $(document).ready(function () {
            $(window).resize(function () {
                
            });

            if (dev) {
                startGame($("#play"));
            }
            $("#play").on('click', function () {
                startGame($(this));
            });
        });
    </script>
</head>
<body>
    <div id="container">
        <audio id="so1">
            <source src="./mp3/so1.mp3" type="audio/mp3">
        </audio>
        <audio id="so2">
            <source src="./mp3/so2.mp3" type="audio/mp3">
        </audio>
        <audio id="so3">
            <source src="./mp3/so3.mp3" type="audio/mp3">
        </audio>
        <audio id="so4">
            <source src="./mp3/so4.mp3" type="audio/mp3">
        </audio>
        <audio id="so5">
            <source src="./mp3/so5.mp3" type="audio/mp3">
        </audio>
        <svg id="play" xmlns="http://www.w3.org/2000/svg" fill="green" viewBox=" 0 0 100 100">
            <polygon points="0,0 100,50 0,100" />
        </svg>

        <svg xmlns:dc="http://purl.org/dc/elements/1.1/"
             xmlns:cc="http://creativecommons.org/ns#"
             xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
             xmlns:svg="http://www.w3.org/2000/svg"
             xmlns="http://www.w3.org/2000/svg"
             xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
             xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
             id="rocket"
             viewBox="0 0 24 32"
             class="hide"
             version="1.1"
             sodipodi:docname="rocket2.svg"
             width="24"
             height="32"
             style="fill:#2f4f4f"
             inkscape:version="0.92.3 (2405546, 2018-03-11)">
            <metadata id="metadata3729">
                <rdf:RDF>
                    <cc:Work rdf:about="">
                        <dc:format>image/svg+xml</dc:format>
                        <dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
                        <dc:title />
                    </cc:Work>
                </rdf:RDF>
            </metadata>
            <defs id="defs3727" />
            <sodipodi:namedview pagecolor="#ffffff"
                                bordercolor="#666666"
                                borderopacity="1"
                                objecttolerance="10"
                                gridtolerance="10"
                                guidetolerance="10"
                                inkscape:pageopacity="0"
                                inkscape:pageshadow="2"
                                inkscape:window-width="768"
                                inkscape:window-height="711"
                                id="namedview3725"
                                showgrid="false"
                                fit-margin-top="-2.7755576e-017"
                                inkscape:zoom="6.0398704"
                                inkscape:cx="14.15038"
                                inkscape:cy="0.93147574"
                                inkscape:window-x="441"
                                inkscape:window-y="31"
                                inkscape:window-maximized="0"
                                inkscape:current-layer="rocket" />
            <path d="M 7.411577,21.39 3.357779,24 3.0917922,22.947 c -0.1869907,-0.744 -0.085996,-1.534 0.281986,-2.199 l 2.6168696,-4.729 c 0.3869807,1.6 0.8479577,3.272 1.4209292,5.371 z m 13.214342,-0.642 -2.645868,-4.784 c -0.390981,1.656 -0.80296,3.22 -1.368932,5.441 L 20.642918,24 20.908905,22.947 c 0.18599,-0.743 0.08499,-1.533 -0.282986,-2.199 z M 10.553421,24 h 2.894855 l 0.551973,-2 H 10.000448 Z M 12.000349,-1e-6 c -3.4888268,2.503 -4.9997515,5.488 -4.9997515,9.191 C 7.0005975,12.531 8.1465404,16.466 9.3804789,21 h 5.2727371 c 1.180941,-4.668 2.311885,-8.577 2.346883,-11.844001 0.04,-3.731 -1.440928,-6.639 -4.99975,-9.156 z m 0.012,2.543 c 1.378931,1.201 2.235889,2.491 2.661867,3.996 -0.557972,0.304 -1.60692,0.461 -2.673866,0.461 -1.038949,0 -2.0718974,-0.145 -2.6408691,-0.433 0.441978,-1.512 1.3039351,-2.824 2.6528681,-4.024 z"
                  id="path3722"/>
            <ellipse style="fill:#ff0000; display:none"
                     id="fire-red"
                     cx="11.970732"
                     cy="26.84878"
                     rx="1.0243902"
                     ry="2.692683" />
            <ellipse style="fill:#ffcc00; display:none"
                     id="fire-yellow"
                     cx="11.968239"
                     cy="26.326839"
                     rx="0.62464041"
                     ry="1.6167839" />
        </svg>

        <div id="planet"></div>
    </div>

</body>
</html>